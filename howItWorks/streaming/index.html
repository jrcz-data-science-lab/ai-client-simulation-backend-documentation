<!doctype html>
<html lang="en">

<head>
        <title>Overview - ai-backend-docs</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../assets/css/darcula-highlight.min.css">

        <link rel="stylesheet" href="../../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="../../assets/css/dracula-ui.min.css">
        <link rel="stylesheet" href="../../assets/css/mkdocs.min.css">

        
            <link  rel="icon" type="image/x-icon" href="../../assets/img/favicon.ico">
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="drac-bg-black-secondary drac-text-grey-ternary drac-text drac-scrollbar-purple">

    <main class="d-flex">

        <!-- block sidebar -->
            <nav id="sidebar" class="sidebar drac-bg-black">
    <div class="custom-menu">
        <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Menu</span>
        </button>
    </div>

    <div class="p-4">
        

        <div class="drac-text-center">
            
                <span class="drac-text drac-line-height drac-text-white">ai-backend-docs</span>
            
        </div>

        <div class="drac-box flex-column">
            <ul class="dot-ul">
                <li><div class="dot-li drac-bg-cyan"></div></li>
                <li><div class="dot-li drac-bg-green"></div></li>
                <li><div class="dot-li drac-bg-orange"></div></li>
                <li><div class="dot-li drac-bg-pink"></div></li>
                <li><div class="dot-li drac-bg-purple"></div></li>
                <li><div class="dot-li drac-bg-red"></div></li>
                <li><div class="dot-li drac-bg-yellow"></div></li>
            </ul>
        </div>

        <hr class="drac-divider" />

        <!-- block menu -->
        <ul class="mb-5 drac-list drac-list-none">
            
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    General overview of the workings
                </a>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class=" active 
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#howitworks-collapse" aria-expanded="false">
                    howItWorks
                </a>
                <div class="collapse" id="howitworks-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../apigateway/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            API gateway
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../code/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            API Interaction Script
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../dockerCompose/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Docker Compose Setup for AudioStreamer Project
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="./"
            class=" active 
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Overview
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../tts/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Tts
        </a>
    </li>
                    </ul>
                </div>
            </li>
            <li class="drac-box">
                <a href="../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#nginx-collapse" aria-expanded="false">
                    Nginx
                </a>
                <div class="collapse" id="nginx-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../nginx/nginxCode/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Code for the nginx setup
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../nginx/nginxConf/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            NGINX Configuration Explanation
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../nginx/proxyConf/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            NGINX SSL and Proxy Configuration Explanation
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../nginx/proxyParams/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Proxy Header Configuration Explanation
        </a>
    </li>
                    </ul>
                </div>
            </li>
        </ul>
        <!-- endblock -->
    </div>
</nav>
        <!-- endblock -->

        <nav class="divider drac-bg-purple-cyan"></nav>

        <div class="content">
            <!-- block header -->
                <header>
    <nav class="navbar navbar-expand-xl drac-bg-purple">
        <div class="container-fluid">
            
            <button class="navbar-toggler w-100 text-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
                aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
                <ul class="navbar-nav text-md-center">

                    <!-- block preview -->
                    <li class="nav-item">
                            
        <div class="container">
            <div class="row row-preview">
                <div class="col">
                    <a href="../dockerCompose/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </div>
                <div class="col">
                    <a href="../tts/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover" style="padding-left: 3%;">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
                    </li>
                    <!--  endblock -->

                    <!-- block search -->
                    <li class="nav-item"><div role="search" class="search-box">
	<form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
		<input type="text" name="q" class="drac-input drac-input-search drac-input-white drac-text-white drac-bg-black-secondary"
		placeholder="Search docs" title="Type search term here" />
	</form>
</div>
                    </li>
                    <!--  endblock -->

                    <!-- block source -->
                    <li class="nav-item">
                        
                    </li>
                    <!--  endblock -->

                </ul>
            </div>

        </div>
    </nav>
</header>
            <!-- endblock -->

            <!-- block content -->
                <section class="p-md-5 section-content">
    <article>
        <p><h1 id="overview">Overview</h1>
<p>This FastAPI application provides real-time audio transcription using OpenAI's Whisper model. It allows clients to send audio data over HTTP or WebSocket, processes the audio, transcribes it, and optionally sends the transcription to an external API. Additionally, it supports generating audio from the transcription using a Text-to-Speech (TTS) model.</p>
<h2 id="environment-variables">Environment Variables</h2>
<p>The application utilizes the following environment variables:</p>
<ul>
<li><strong><code>API_PORT</code></strong>: The port on which the FastAPI application will run (default: <code>1000</code>).</li>
<li><strong><code>WHISPER_MODEL</code></strong>: The Whisper model to be loaded (default: <code>base</code>).</li>
<li><strong><code>TEXT_TO_SPEECH</code></strong>: The port for the Text-to-Speech service (default: <code>base</code>).</li>
</ul>
<p>You can set these variables in your environment or use a <code>.env</code> file.</p>
<h2 id="endpoints">Endpoints</h2>
<h3 id="get">GET /</h3>
<p>This endpoint performs a health check to verify that the server is running and the Whisper model is loaded.</p>
<h4 id="response">Response:</h4>
<ul>
<li><code>200 OK</code>: Returns a message indicating the Whisper model in use.</li>
</ul>
<p>Example Response:</p>
<pre><code class="language-json">{
  &quot;message&quot;: &quot;The model is running on base model&quot;
}
</code></pre>
<h3 id="post-process-audio">POST /process-audio</h3>
<p>This HTTP endpoint accepts base64-encoded audio data, transcribes it using OpenAI's Whisper model, and returns the transcription.</p>
<h4 id="request-body">Request Body:</h4>
<pre><code class="language-json">{
  &quot;username&quot;: &quot;user123&quot;,
  &quot;audio&quot;: &quot;base64_encoded_audio_data&quot;
}
</code></pre>
<ul>
<li><code>username</code>: A string representing the user's unique identifier.</li>
<li><code>audio</code>: The audio data in base64 encoding (e.g., a WebM or WAV file).</li>
</ul>
<h4 id="response_1">Response:</h4>
<p>Returns the transcription result.</p>
<pre><code class="language-json">{
  &quot;username&quot;: &quot;user123&quot;,
  &quot;transcription&quot;: &quot;This is the transcribed text.&quot;
}
</code></pre>
<h3 id="post-send-transcription">POST /send-transcription</h3>
<p>This endpoint triggers the sending of the transcribed text to an external API and sends the synthesized audio (via TTS) to the user.</p>
<h4 id="request-body_1">Request Body:</h4>
<pre><code class="language-json">{
  &quot;username&quot;: &quot;user123&quot;
}
</code></pre>
<ul>
<li><code>username</code>: The unique identifier for the user.</li>
</ul>
<h4 id="response_2">Response:</h4>
<pre><code class="language-json">{
  &quot;text&quot;: &quot;This is the transcribed text.&quot;,
  &quot;voice&quot;: &quot;audio/user123_audio.wav&quot;
}
</code></pre>
<ul>
<li><code>text</code>: The response from the external API after sending the transcription.</li>
<li><code>voice</code>: The URL of the generated audio file from the Text-to-Speech service.</li>
</ul>
<h3 id="get-get-audiousername">GET /get-audio/{username}</h3>
<p>This endpoint serves the synthesized audio file (in WAV format) generated from the transcription.</p>
<h4 id="parameters">Parameters:</h4>
<ul>
<li><code>username</code>: The user's unique identifier.</li>
</ul>
<h4 id="response_3">Response:</h4>
<ul>
<li><code>200 OK</code>: Returns the audio file (<code>audio/{username}_audio.wav</code>).</li>
<li><code>404 Not Found</code>: If the audio file does not exist.</li>
</ul>
<h2 id="functions">Functions</h2>
<h3 id="process_wav_byteswebm_bytes-bytes-sample_rate-int-12000"><code>process_wav_bytes(webm_bytes: bytes, sample_rate: int = 12000)</code></h3>
<p>Processes incoming WebM audio bytes to convert and load them as a waveform suitable for transcription.</p>
<h4 id="parameters_1">Parameters:</h4>
<ul>
<li><code>webm_bytes</code> (bytes): The audio bytes in WebM format.</li>
<li><code>sample_rate</code> (int): The sample rate for audio processing (default: 12000).</li>
</ul>
<h4 id="returns">Returns:</h4>
<ul>
<li>The processed audio waveform, ready for transcription by Whisper.</li>
</ul>
<h3 id="send_transcription_to_apigatewayfile_path-str-username-str"><code>send_transcription_to_apigateway(file_path: str, username: str)</code></h3>
<p>Sends the transcription text to an external API for further processing.</p>
<h4 id="parameters_2">Parameters:</h4>
<ul>
<li><code>file_path</code> (str): The path to the transcription text file.</li>
<li><code>username</code> (str): The user's unique identifier.</li>
</ul>
<h4 id="returns_1">Returns:</h4>
<ul>
<li>The JSON response from the external API, if successful.</li>
</ul>
<h3 id="send_transcription_to_ttstext-str-username-str"><code>send_transcription_to_tts(text: str, username: str)</code></h3>
<p>Sends the transcription text to a Text-to-Speech (TTS) service and saves the resulting audio.</p>
<h4 id="parameters_3">Parameters:</h4>
<ul>
<li><code>text</code> (str): The transcription text to convert to speech.</li>
<li><code>username</code> (str): The user's unique identifier.</li>
</ul>
<h4 id="side-effects">Side Effects:</h4>
<ul>
<li>Saves the resulting audio as a WAV file in the <code>audio/</code> directory under the user's name (<code>audio/{username}_audio.wav</code>).</li>
</ul></p>
    </article>
</section>
            <!-- endblock -->

            <!-- block footer -->
                <footer>
    <div class="d-flex flex-sm-row justify-content-between py-2 border-top drac-text-black drac-bg-cyan-green">
        <a href="https://github.com/dracula/mkdocs" target="_blank" style="padding-left: 1%;"
            class="footer-text drac-anchor drac-text-black drac-text-purple--hover">
            Made with Dracula Theme for MkDocs
        </a>
    </div>
</footer>
            <!-- endblock -->
        </div>

    </main>

        <script>var base_url = '../..';</script>
        <script src="../../assets/js/jquery-3.3.1.slim.min.js"></script>
        <script src="../../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../../assets/js/mkdocs.js"></script>
			<script src="../../search/main.js" defer></script>

</body>

</html>